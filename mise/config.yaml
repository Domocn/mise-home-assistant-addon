# Home Assistant Add-on Configuration
name: "Mise"
version: "1.0.0"
slug: "mise"
description: "Self-hosted family recipe management, meal planning, and cooking assistant"
url: "https://github.com/Domocn/Mise"
arch:
  - amd64
  - aarch64
  - armv7
startup: application
boot: auto
ingress: true
ingress_port: 3000
ingress_stream: true
panel_icon: mdi:chef-hat
panel_title: Mise
homeassistant_api: true
host_network: false
init: false

# Map config and data directories for persistence
map:
  - config:rw
  - share:rw
  - ssl:ro

# Ports configuration
ports:
  3000/tcp: null
  8001/tcp: null

ports_description:
  3000/tcp: "Web UI (optional, use ingress instead)"
  8001/tcp: "Backend API (optional)"

# Add-on options with defaults
options:
  jwt_secret: ""
  llm_provider: "embedded"
  ollama_url: "http://homeassistant.local:11434"
  ollama_model: "llama3"
  openai_api_key: ""
  anthropic_api_key: ""
  google_ai_api_key: ""
  email_enabled: false
  smtp_server: ""
  smtp_port: 587
  smtp_username: ""
  smtp_password: ""
  smtp_from_email: ""
  enable_registration: true
  enable_oauth_google: false
  google_client_id: ""
  google_client_secret: ""
  enable_oauth_github: false
  github_client_id: ""
  github_client_secret: ""

# Schema for validating options
schema:
  jwt_secret: "str?"
  llm_provider: "list(embedded|ollama|openai|anthropic|google)?"
  ollama_url: "url?"
  ollama_model: "str?"
  openai_api_key: "str?"
  anthropic_api_key: "str?"
  google_ai_api_key: "str?"
  email_enabled: "bool?"
  smtp_server: "str?"
  smtp_port: "int?"
  smtp_username: "str?"
  smtp_password: "str?"
  smtp_from_email: "email?"
  enable_registration: "bool?"
  enable_oauth_google: "bool?"
  google_client_id: "str?"
  google_client_secret: "str?"
  enable_oauth_github: "bool?"
  github_client_id: "str?"
  github_client_secret: "str?"

# Environment variables from options
environment:
  MISE_HA_ADDON: "true"

# Labels
labels:
  io.hass.name: "Mise"
  io.hass.description: "Self-hosted family recipe management and meal planning"
  io.hass.type: "addon"

# Watchdog for health monitoring
watchdog: "http://[HOST]:[PORT:3000]/"

# Backup paths
backup_exclude:
  - "*.log"
  - "__pycache__"
  - "node_modules"

# Resources
resources_limits: false
